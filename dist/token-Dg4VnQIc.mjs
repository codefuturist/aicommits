var T=Object.defineProperty;var o=(n,p)=>T(n,"name",{value:p,configurable:!0});import{r as w,g as h}from"./cli-DGXyOzRB.mjs";import{r as b}from"./token-util-MZgMnMFM.mjs";function j(n,p){return p.forEach(function(a){a&&typeof a!="string"&&!Array.isArray(a)&&Object.keys(a).forEach(function(i){if(i!=="default"&&!(i in n)){var s=Object.getOwnPropertyDescriptor(a,i);Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:o(function(){return a[i]},"get")})}})}),Object.freeze(n)}o(j,"_mergeNamespaces");var k,O;function m(){if(O)return k;O=1;var n=Object.defineProperty,p=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,s=o((e,r)=>{for(var t in r)n(e,t,{get:r[t],enumerable:!0})},"__export"),y=o((e,r,t,f)=>{if(r&&typeof r=="object"||typeof r=="function")for(let u of a(r))!i.call(e,u)&&u!==t&&n(e,u,{get:o(()=>r[u],"get"),enumerable:!(f=p(r,u))||f.enumerable});return e},"__copyProps"),d=o(e=>y(n({},"__esModule",{value:!0}),e),"__toCommonJS"),_={};s(_,{refreshToken:o(()=>g,"refreshToken")}),k=d(_);var l=w(),c=b();async function g(){const{projectId:e,teamId:r}=(0,c.findProjectInfo)();let t=(0,c.loadToken)(e);if(!t||(0,c.isExpired)((0,c.getTokenPayload)(t.token))){const f=await(0,c.getVercelCliToken)();if(!f)throw new l.VercelOidcTokenError("Failed to refresh OIDC token: Log in to Vercel CLI and link your project with `vc link`");if(!e)throw new l.VercelOidcTokenError("Failed to refresh OIDC token: Try re-linking your project with `vc link`");if(t=await(0,c.getVercelOidcToken)(f,e,r),!t)throw new l.VercelOidcTokenError("Failed to refresh OIDC token");(0,c.saveToken)(t,e)}process.env.VERCEL_OIDC_TOKEN=t.token}return o(g,"refreshToken"),k}o(m,"requireToken");var v=m(),P=h(v),E=j({__proto__:null,default:P},[v]);export{E as t};
